---
title: kubectl을 사용해서 디플로이먼트 생성하기
weight: 10
description: |-
  애플리케이션 배포에 대해 알아보기.
  kubectl을 사용하여 쿠버네티스에 첫 번째 앱 배포.
---

<!DOCTYPE html>

<html lang="ko">

<body>

<div class="layout" id="top">

    <main class="content">

        <div class="row">
            <div class="col-md-8">
                <h3>목표</h3>
                <ul>
                    <li>애플리케이션 디플로이먼트(Deployment)에 대해 배운다.</li>
                    <li>kubectl로 첫 애플리케이션을 쿠버네티스에 배포한다.</li>
                </ul>
            </div>

            <div class="col-md-8">
                <h3>쿠버네티스 디플로이먼트</h3>
                <p>
                    일단 <a href="/ko/docs/tutorials/kubernetes-basics/create-cluster/cluster-intro/">쿠버네티스 클러스터를 구동시키면</a>, 그 위에 컨테이너화된 애플리케이션을 배포할 수 있다.
                    그러기 위해서, 쿠버네티스 <b>디플로이먼트</b> 설정을 만들어야 한다. 디플로이먼트는 쿠버네티스가
                    애플리케이션의 인스턴스를 어떻게 생성하고 업데이트해야 하는지를 지시한다. 디플로이먼트가 만들어지면,
                    쿠버네티스 컨트롤 플레인이 해당 디플로이먼트에 포함된 애플리케이션 인스턴스가 클러스터의 개별 노드에서 실행되도록 
                    스케줄한다.
                </p>

                <p>애플리케이션 인스턴스가 생성되면, 쿠버네티스 디플로이먼트 컨트롤러는 지속적으로 이들 인스턴스를 모니터링한다. 인스턴스를 구동 중인 노드가 다운되거나 삭제되면, 디플로이먼트 컨트롤러가 인스턴스를 클러스터 내부의 다른 노드의 인스턴스로 교체시켜준다.<b>이렇게 머신의 장애나 정비에 대응할 수 있는 자동 복구(self-healing) 메커니즘을 제공한다.</b></p>

                <p>오케스트레이션 기능이 없던 환경에서는, 설치 스크립트가 애플리케이션을 시작하는데 종종 사용되곤 했지만, 머신의 장애가 발생한 경우 복구를 해주지는 않았다. 쿠버네티스 디플로이먼트는 애플리케이션 인스턴스를 생성해주고 여러 노드에 걸쳐서 지속적으로 인스턴스가 구동되도록 하는 두 가지를 모두 하기 때문에 애플리케이션 관리를 위한 접근법에서 근본적인 차이를 가져다준다.</p>

            </div>

            <div class="col-md-4">
                <div class="content__box content__box_lined">
                    <h3>요약:</h3>
                    <ul>
                        <li>디플로이먼트</li>
                        <li>Kubectl</li>
                    </ul>
                </div>
                <div class="content__box content__box_fill">
                    <p><i>
                        디플로이먼트는 애플리케이션 인스턴스를 생성하고 업데이트하는 역할을 담당한다.
                    </i></p>
                </div>
            </div>
        </div>
        <br>

        <div class="row">
            <div class="col-md-8">
                <h2 style="color: #3771e3;">쿠버네티스에 첫 번째 애플리케이션 배포하기</h2>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8">
                <p><img src="/docs/tutorials/kubernetes-basics/public/images/module_02_first_app.svg"></p>
            </div>
        </div>
        <br>

        <div class="row">
            <div class="col-md-8">

                <p><b>kubectl</b>이라는 쿠버네티스 CLI를 통해 디플로이먼트를 생성하고 관리할 수 있다. Kubectl은 클러스터와 상호 작용하기 위해 쿠버네티스 API를 사용한다. 이 모듈에서는, 쿠버네티스 클러스터 상에 애플리케이션을 구동시키는 디플로이먼트를 생성하기 위해 필요한 가장 일반적인 Kubectl 명령어를 배우게 된다.</p>

                <p>디플로이먼트를 생성할 때, 애플리케이션에 대한 컨테이너 이미지와 구동시키고자 하는 복제 수를 지정해야 한다. 디플로이먼트를 업데이트해서 이런 정보를 나중에 변경할 수 있다. 모듈 <a href="/ko/docs/tutorials/kubernetes-basics/scale/scale-intro/">5</a>와 <a href="/ko/docs/tutorials/kubernetes-basics/update/update-intro/">6</a>의 부트캠프에서 어떻게 스케일하고 업데이트하는지에 대해 다룬다.</p>




            </div>
            <div class="col-md-4">
                <div class="content__box content__box_fill">
                    <p><i> 애플리케이션이 쿠버네티스 상에 배포되려면 지원되는 컨테이너 형식 중 하나로 패키지 되어야한다. </i></p>
                </div>
            </div>
        </div>

        <div class="row">
            <div class="col-md-8">
                <p>
                  첫 번째 디플로이먼트로, NGINX를 사용해 모든 요청을 에코(echo)하는 도커 컨테이너로 패키지한 hello-node 애플리케이션을 사용해보자. (아직 hello-node 애플리케이션을 작성하고 컨테이너를 활용해서 배포해보지 않았다면, <a href="/ko/docs/tutorials/hello-minikube/">Hello Minikube 튜토리얼</a>의 지시를 따른다.)</p>
                <p>kubectl도 설치해야 한다. 설치해야 하는 경우, <a href="/ko/docs/tasks/tools/#kubectl">도구 설치</a>를 방문하자.</p>
                <p>이제 디플로이먼트를 이해했으니, 우리의 첫 번째 애플리케이션을 배포해보자!</p>
            </div>
        </div>
        <br>

        <div class="row">
            <div class="col-md-8">
                <h3>kubectl 기본 사항</h3>
                <p>kubectl 명령의 일반적인 형식은 다음과 같다: <code>kubectl <i>action resource</i></code></p>
                <p>이것은 지정된 <em>리소스</em>(예: <tt>노드</tt> 또는 <tt>디플로이먼트(deployment)</tt>)에 지정된 <em>작업</em>(생성, 설명 또는 삭제)을 수행한다. 하위 명령 뒤에 <code>-<span />-help</code>를 사용하여 가능한 매개변수에 대한 추가 정보를 얻을 수 있다. (예: <code>kubectl get nodes --help</code>).</p>
                <p><b><code>kubectl version</code></b> 명령을 실행하여, kubectl이 클러스터와 통신하도록 구성되어 있는지 확인해보자.</p>
                <p>kubectl이 설치되어 있고 클라이언트 및 서버 버전을 모두 볼 수 있는지 확인해보자.</p>
                <p>클러스터의 노드를 보려면, <b><code>kubectl get nodes</code></b> 명령을 실행해보자.</p>
                <p>사용 가능한 노드가 표시된다. 나중에, 쿠버네티스는 사용 가능한 노드 리소스를 기반으로 애플리케이션을 배포할 위치를 선택한다.</p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h3>앱 배포</h3>
                <p><code>kubectl create deployment</code> 명령을 사용하여 쿠버네티스에 첫 번째 앱을 배포해 보자. 디플로이먼트(deployment) 이름과 앱 이미지 위치를(도커 허브 외부에서 호스팅되는 이미지의 전체 리포지터리 URL 포함) 제공해야 한다.</p>
                <p><b><code>kubectl create deployment kubernetes-bootcamp --image=gcr.io/google-samples/kubernetes-bootcamp:v1</code></b></p>
                <p>좋다! 디플로이먼트(deployment)를 생성하여 첫 번째 애플리케이션을 배포했다. 이것은 당신을 위해 몇 가지를 수행했다:</p>
                <ul>
                <li>애플리케이션의 인스턴스를 실행할 수 있는 적합한 노드를 검색(사용 가능한 노드는 1개뿐)했다.</li>
                <li>해당 노드에서 실행되도록 애플리케이션을 스케줄했다.</li>
                <li>필요할 때 새 노드에서 인스턴스를 다시 스케줄하도록 클러스터를 구성했다.</li>
                </ul>
                <p>디플로이먼트를 나열하려면 <code>kubectl get deployments</code> 명령을 사용하자:</p>
                <p><b><code>kubectl get deployments</code></b></p>
                <p>앱의 단일 인스턴스를 실행하는 디플로이먼트가 1개 있음을 확인할 수 있다. 인스턴스가 노드의 컨테이너 내에서 실행 중이다.</p>
            </div>
        </div>
        <div class="row">
            <div class="col-md-12">
                <h3>앱 보기</h3>
                <p>쿠버네티스 내부에서 실행 중인 파드는 격리된, 프라이빗 네트워크에서 실행된다.
                기본적으로 동일한 쿠버네티스 클러스터 내의 다른 파드 및 서비스에서 볼 수 있지만 해당 네트워크 외부에서는 볼 수 없다.
                <code>kubectl</code>을 사용할 때, API 엔드포인트를 통해 상호 작용하여 애플리케이션과 통신한다.</p>
                <p>모듈 4에서 쿠버네티스 클러스터 외부에 애플리케이션을 노출하는 방법에 대한 다른 옵션을 다룰 것이다.</p>
                <p><code>kubectl</code> 명령은 클러스터-전체의 프라이빗 네트워크로 통신을 전달할 프록시를 생성할 수 있다. 프록시는 control-C를 눌러 종료할 수 있으며 실행 중에 출력을 표시하지 않는다. </p>
                <p><strong>프록시를 실행하려면 두 번째 터미널 창을 열어야 한다.</strong></p>
                <p><b><code>kubectl proxy</b></code>
                <p>이제 호스트(온라인 터미널)와 쿠버네티스 클러스터가 연결되었다. 프록시를 사용하면 터미널에서 API에 직접 접근할 수 있다.</p>
                <p>프록시 엔드포인트를 통해 호스팅되는 모든 API를 볼 수 있다. 예를 들어, <code>curl</code> 명령을 사용하여 API를 통해 직접 버전을 쿼리할 수 있다:</p>
                <p><b><code>curl http://localhost:8001/version</code></b></p>
                <div class="alert alert-info note callout" role="alert"><strong>노트:</strong> 포트 8001에 액세스할 수 없는 경우, <code>kubectl proxy</code>가 두 번째 터미널에서 실행 중인지 확인해보자.</div>
                <p>API 서버는 프록시를 통해서도 접근할 수 있는 각 파드의 이름 기반으로 생성된 파드의 엔드포인트를 자동 생성한다.</p>
                <p>먼저 파드 이름을 가져와야 하며, 환경 변수 <tt>POD_NAME</tt>에 저장한다:</p>
                <p><b><code>export POD_NAME=$(kubectl get pods -o go-template --template '{{range .items}}{{.metadata.name}}{{"\n"}}{{end}}')</code></b><br />
                   <b><code>파드 이름 확인: $POD_NAME</code></b></p>
                <p>다음을 실행하여 프록시 API를 통해 파드에 접근할 수 있다:</p>
                <p><b><code>curl http://localhost:8001/api/v1/namespaces/default/pods/$POD_NAME/</code></b></p>
                <p>프록시를 사용하지 않고 새 디플로이먼트에 접근하려면, 다음 모듈에서 설명할 서비스(Service)가 필요하다.</p>
            </div>

        </div>
        <div class="row">
            <p>
              준비가 됐다면, <a href="/ko/docs/tutorials/kubernetes-basics/explore/explore-intro/" title="Viewing Pods and Nodes">파드 및 노드 보기</a>로 이동하자.</p>
            </p>
        </div>


    </main>

</div>

</body>
</html>
